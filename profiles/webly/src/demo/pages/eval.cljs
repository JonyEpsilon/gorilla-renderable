(ns demo.pages.eval
  (:require
   [re-frame.core :as rf]
   [webly.web.handler :refer [reagent-page]]
   [picasso.kernel.picasso :refer [picasso-result]]
   [picasso.kernel.cell :refer [eval-cell]]))

(defn link-fn [fun text]
  [:a.bg-blue-300.cursor-pointer.hover:bg-red-700.m-1
   {:on-click fun} text])

(defn link-dispatch [rf-evt text]
  (link-fn #(rf/dispatch rf-evt) text))

(defn link-href [href text]
  [:a.bg-blue-300.cursor-pointer.hover:bg-red-700.m-1
   {:href href} text])

(defn block [& children]
  (into [:div.bg-blue-400.m-5.inline-block {:class "w-1/4"}]
        children))


(def data-list-like
  {:type :list-like
   :content {:class "clj-vector"
             :open "["
             :close "]"
             :separator " "
             :items [{:type :hiccup
                      :content [:span {:class "clj-long"} "1"]}
                     {:type :hiccup
                      :content [:span {:class "clj-long"} "2"]}
                     {:type :hiccup
                      :content [:span {:class "clj-long"} "3"]}]}})

(def data-hiccup
  {:type :hiccup
   :content [:span {:class "clj-long"} "1"]})




(defmethod reagent-page :demo/eval [& args]
  [:div
   [:p [link-dispatch [:bidi/goto  :demo/main] "main"]]
   [:h1 "picasso eval"]

   [block
   [:p.text-4xl "picasso painter"]
    [:p "hiccup painter:"]
     [picasso-result data-hiccup]

     [:p "list-like painter:"]
     [picasso-result data-list-like]]
   
    [block
   [:p.text-4xl "picasso eval"]
   [:p "edn eval"]
   [eval-cell {:kernel :edn :code "[7 8]"}]]

])
